/// Work out the required size for the cell.
///
/// @param {Number|List} $layout - The single value/list to work out sizing.
/// @param {Number}      $index  - The position of the list to get the value from.
/// @param {Number}      $gutter - The gutter value to substract from the size.
///
/// @return {String}
///
@function -cell-size($layout, $index, $gutter) {
  $total: if(type-of($layout) == 'list', sum($layout), $layout);
  $length: length($layout);
  $item: if(type-of($layout) == 'list', nth($layout, $index), 1);
  $fr: -sort-fractional($layout);
  $static: -sort-static($layout, length($fr), '-');
  $calc-gutter: if($gutter != 0, -calc-gutter($gutter, $layout), null);
  $size: 0;

  // Shrink behaviour (auto width/height)
  @if $item == 0 {
    $size: auto;
  }
  @else if not unitless($item) {
    @if $calc-gutter {
      $size: calc(#{$item} - #{$calc-gutter});
    } @else {
      $size: #{$item};
    }
  } @else {
    @if $static {
      @if $calc-gutter {
        $size: calc(#{percentage($item / $total)} #{$static} - #{$calc-gutter});
      }
      @else {
        $size: calc(#{percentage($item / $total)} #{$static});
      }
    }
    @else {
      @if $calc-gutter {
        $size: calc(#{percentage($item / $total)} - #{$calc-gutter});
      }
      @else {
        $size: calc(#{percentage($item / $total)});
      }
    }
  }

  @return $size;
}
